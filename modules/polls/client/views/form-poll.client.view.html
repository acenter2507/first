<section class="container">
  <!-- Toolbar -->
  <div class="row mg20t mg20b">
    <div class="col-xs-12">
      <div class="form-group">
        <button class="btn btn-danger pull-right" ng-show="vm.poll._id" ng-click="vm.remove()">Delete</button>
        <button class="btn btn-default pull-right mg10r" ng-click="vm.discard()">Discard</button>
        <button class="btn btn-primary pull-right mg10r" ng-click="vm.save(true)">{{vm.poll._id ? ' Update' : ' Create'}}</button>
      </div>
    </div>
  </div>

  <!-- Form -->
  <div class="row ">
    <div class="col-xs-12">
      <div class="card">
        <!-- Category -->
        <div class="col-xs-9 col-sm-10 col-md-10 col-lg-10">
          <div class="w200">
            <!-- Trường hợp edit poll -->
            <div class="select" ng-if="vm.poll._id">
              <select ng-model="vm.poll.category._id" id="category" name="category" ng-options="category._id as category.name for category in vm.categorys"></select>
              <div class="select__arrow"></div>
            </div>
            <!-- Trường hợp create poll -->
            <div class="select" ng-if="!vm.poll._id">
              <select ng-model="vm.poll.category" id="category" name="category">
                <option value="" selected>Category</option>
                <option ng-repeat="category in vm.categorys" value="{{category._id}}">{{category.name}}</option>
              </select>
              <div class="select__arrow"></div>
            </div>
            <p class="text-danger" ng-hide="vm.validateCategory()">Category is required</p>
          </div>
        </div>
        <div class="col-xs-3 col-sm-2 col-md-2 col-lg-2">
          <span class="pull-right">
            <a bs-dropdown aria-haspopup="true" aria-expanded="false">
              <i class="fa fa-cog fa-2x"></i>
            </a>
            <ul class="dropdown-menu" role="menu">
              <li>
                <label class="control control--checkbox inline-block">Public
                  <input type="checkbox" name="isPublic" ng-model="vm.poll.isPublic"/>
                  <div class="control__indicator"></div>
                  <md-tooltip md-direction="bottom">Everyone can see your poll</md-tooltip>
                </label>
              </li>
              <li>
                <label class="control control--checkbox inline-block mg20l">Allow guest vote
                  <input type="checkbox" name="allow_guest" ng-model="vm.poll.allow_guest"/>
                  <div class="control__indicator"></div>
                  <md-tooltip md-direction="bottom">Everyone can vote your poll</md-tooltip>
                </label>
              </li>
              <li>
                <label class="control control--checkbox inline-block mg20l">Allow multiple vote
                  <input type="checkbox" name="allow_multiple" ng-model="vm.poll.allow_multiple"/>
                  <div class="control__indicator"></div>
                  <md-tooltip md-direction="bottom">You can vote more than 1 option</md-tooltip>
                </label>
              </li>
              <li>
                <label class="control control--checkbox inline-block mg20l">Allow members suggest option
                  <input type="checkbox" name="allow_add" ng-model="vm.poll.allow_add"/>
                  <div class="control__indicator"></div>
                  <md-tooltip md-direction="bottom">You will get suggestions from members</md-tooltip>
                </label>
              </li>
            </ul>
          </span>
        </div>
        <div class="clearfix h20"></div>
        <!-- Checkbox -->
        <!--<div class="control-group">
          <label class="control control--checkbox inline-block mg20l">Allow guest vote
            <input type="checkbox" name="allow_guest" ng-model="vm.poll.allow_guest"/>
            <div class="control__indicator"></div>
            <md-tooltip md-direction="bottom">Everyone can vote your poll</md-tooltip>
          </label>
          <label class="control control--checkbox inline-block mg20l">Allow members suggest option
            <input type="checkbox" name="allow_add" ng-model="vm.poll.allow_add"/>
            <div class="control__indicator"></div>
            <md-tooltip md-direction="bottom">You will get suggestions from members</md-tooltip>
          </label>
        </div>-->
        <!-- Title -->
        <input type="text" class="form-control input-large" name="title" ng-model="vm.poll.title" placeholder="Enter your poll tilte here"
        />
        <p class="text-danger" ng-hide="vm.validateTitle()">You must type somthing for title</p>
        <div class="h20"></div>
        <!-- Body -->
        <text-angular class="text-body" ng-model="vm.poll.body"></text-angular>
        <p class="text-danger" ng-hide="vm.validateBody()">You must type somthing for body</p>
        <div class="h20"></div>
        <!-- Tags -->
        <div class="panel-group mgnb" role="tablist" bs-collapse>
          <div class="panel panel-default custom-panel" ng-repeat="opt in vm.opts">
            <div class="panel-heading public" role="tab">
              <h4 class="panel-title">
                <a class="undecorated-link" bs-collapse-toggle>Other</a>
              </h4>
            </div>
            <div class="panel-collapse" role="tabpanel" bs-collapse-target>
              <div class="panel-body">
                <div class="form-group">
                  <label class="control-label" for="close">Stop voting at:</label>
                  <input class="form-control" moment-picker="vm.poll.close" ng-model="vm.poll.close" format="YYYY/MM/DD HH:mm" 
                    start-view="month" placeholder="Select a date...">
                </div>
                <div class="form-group" ng-controller="AutocompleteTagController">
                  <label class="form-label" for="#">Tags</label>
                  <tags-input ng-model="vm.poll.tags" display-property="name" placeholder="{{placeholder}}" add-from-autocomplete-only="true"
                    replace-spaces-with-dashes="false" min-length="1" enforce-max-tags class="tags-custom">
                    <auto-complete source="loadItems($query)" min-length="1" debounce-delay="0" max-results="10"></auto-complete>
                  </tags-input>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="h20"></div>
        <button class="btn btn-primary pull-right" ng-click="vm.input_opt()">Add Option</button>
        <div class="clearfix"></div>
        <div class="h20"></div>
        <!-- Option -->
        <div class="panel-group mgnb" role="tablist" aria-multiselectable="true" bs-collapse ng-if="vm.opts.length > 0">
          <div class="panel panel-default custom-panel" ng-repeat="opt in vm.opts">
            <div ng-class="{'panel-heading': true, 'public': (opt.status == 1), 'watting': (opt.status == 2)}" role="tab">
              <h4 class="panel-title">
                <a class="undecorated-link" bs-collapse-toggle>
                  {{ (opt.title) ? opt.title : 'New option ' + ($index + 1) }}
                </a>
              </h4>
              <small ng-if="opt.status == 2">
                Add by&nbsp;
                <a class="undecorated-link" ui-sref="users.info({userId: opt.user._id})" ng-if="opt.user" ng-bind="opt.user.displayName"></a>
                <span ng-if="!opt.user">Deleted User</span>
                <span>&nbsp;on&nbsp;</span>
                <span ng-bind="opt.created | date:'mediumDate'"></span>
              </small>
            </div>
            <div class="panel-collapse" role="tabpanel" bs-collapse-target>
              <div class="panel-body">
                <div class="pull-right mg10b">
                  <a class="btn btn-info btn-sm" ng-if="opt.status == 1" ng-click="vm.input_opt(opt)">Edit</a>
                  <a class="btn btn-danger btn-sm" ng-if="opt.status == 1" ng-click="vm.remove_opt(opt)">Remove</a>
                  <a class="btn btn-success btn-sm" ng-if="opt.status == 2" ng-click="vm.approve_opt(opt)">Approve</a>
                  <a class="btn btn-warning btn-sm" ng-if="opt.status == 2" ng-click="vm.reject_opt(opt)">Reject</a>
                </div>
                <div class="clearfix"></div>
                <div class="text-body" ta-bind="text" ng-model="opt.body" ta-readonly="true"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toolbar -->
  <div class="row mg20t mg20b">
    <div class="col-xs-12">
      <div class="form-group">
        <button class="btn btn-danger pull-right" ng-show="vm.poll._id" ng-click="vm.remove()">Delete</button>
        <button class="btn btn-default pull-right mg10r" ng-click="vm.discard()">Discard</button>
        <button class="btn btn-primary pull-right mg10r" ng-click="vm.save(true)">{{vm.poll._id ? ' Update' : ' Create'}}</button>
      </div>
    </div>
  </div>
</section>















<!--<div class="row">
    <div class="page-header">
      <h3>{{vm.poll._id ? 'Edit Poll' : 'New Poll'}}</h3>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12 col-sm-12 col-md-7 col-lg-7">
      <form name="vm.form.pollForm" class="form-horizontal" ng-submit="vm.save(vm.form.pollForm.$valid)" novalidate>
        <fieldset>
          <div class="form-group">
            <label class="control-label" for="close">Stop voting at:</label>
            <input id="close" name="close" class="form-control" moment-picker="vm.poll.close" ng-model="vm.poll.close" format="YYYY/MM/DD HH:mm"
              start-view="month" placeholder="Select a date...">
          </div>
          <div class="form-group">
            <button type="submit" class="btn btn-primary"><i class="fa fa-check" aria-hidden="true"></i>{{vm.poll._id ? ' Update' : ' Create'}}</button>
            <a class="btn btn-danger" ng-show="vm.poll._id" ng-click="vm.remove()"><i class="fa fa-trash" aria-hidden="true"></i> Delete</a>
            <a class="btn btn-default" ng-click="vm.discard()"><i class="fa fa-times" aria-hidden="true"></i> Discard</a>
          </div>
          <div ng-show="vm.error" class="text-danger">
            <strong ng-bind="vm.error"></strong>
          </div>
        </fieldset>
      </form>
    </div>
    <div class="col-xs-12 col-sm-12 col-md-5 col-lg-5">
      <p class="text-muted" ng-if="vm.option.length == 0">Has no option added.</p>
      <ul class="list-group">
        <li ng-repeat="opt in vm.opts" class="list-group-item">
          <h4 class="list-group-item-heading text-muted" ng-if="opt.status == 3" ng-bind="opt.title"></h4>
          <h4 class="list-group-item-heading" ng-if="opt.status != 3" ng-bind="opt.title"></h4>

          <p class="text-muted" ng-if="opt.status == 3" ng-bind="opt.body"></p>
          <p ng-if="opt.status != 3" ng-bind="opt.body"></p>

          <a href="#" class="pull-right" ng-if="opt.status == 1" ng-click="vm.input_opt(opt)">Edit</a>
          <a href="#" class="pull-right" ng-if="opt.status == 1" ng-click="vm.remove_opt(opt)">Remove&nbsp;&nbsp;</a>
          <a href="#" class="pull-right" ng-if="opt.status == 2" ng-click="vm.approve_opt(opt)">Approve&nbsp;&nbsp;</a>
          <a href="#" class="pull-right" ng-if="opt.status == 2" ng-click="vm.reject_opt(opt)">Reject&nbsp;&nbsp;</a>
          <p class="pull-right text-muted" ng-if="opt.status == 3">Rejected&nbsp;&nbsp;</p>
          <div class="clearfix"></div>
        </li>
      </ul>
      <button class="btn btn-primary" ng-click="vm.input_opt()"><i class="fa fa-plus" aria-hidden="true"></i> Add option</button>
    </div>
    <div class="clearfix"></div>
  </div>-->
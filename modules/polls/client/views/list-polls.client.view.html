<section class="container mg10b" infinite-scroll="vm.get_polls()" infinite-scroll-distance='2'>
  <!-- Toolbar -->
  <div class="row mg12t">
    <div class="col-xs-12 pdn">
      <div class="custom-toolbar">
        <a ui-sref="polls.create" class="btn btn-primary pull-right">Create poll</a>
        <!--<a ng-click="vm.show_toastr()" class="btn btn-danger pull-right mg10r">Toastr</a>-->
      </div>
    </div>
  </div>

  <div class="row" ng-show="vm.is_has_new_polls">
    <div class="col-xs-12 pdn pd6l pd6r">
      <div class="notice notice-info">
        New poll has just been added, <a class="undecorated-link" ng-click="load_new()">load now</a>.
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-xs-12 col-sm-12 col-md-8 col-lg-6 col-lg-push-3 pdn">
      <div ng-repeat="poll in vm.polls" class="card">
        <div ng-include="'/modules/core/client/views/templates/list-poll.client.template.html'"></div>
      </div>
      <!-- Loading indicator -->
      <div class="row" ng-show="vm.busy">
        <div class="loader"></div>
      </div>
      <div class="notice notice-warning" ng-show="vm.polls.length === 0 && vm.stopped">
        No polls yet, why don't you <a ui-sref="polls.create">create one</a>?
      </div>
    </div>
    <!-- RIGHT -->
    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-3 col-lg-push-3 pdn">
      <!-- Activitys  -->
      <div class="card card-expand card-scroll">
        <div class="card-header">
          <strong class="card-title">Ticker</strong>
          <a class="undecorated-link card-expand-toggle pull-right text-muted"><i class="fa fa-caret-down"></i></a>
        </div>
        <div class="card-body">
          <div class="card-scroll-content">
            <div class="side-list-poll" ng-repeat="activity in vm.activitys">
              <div class="user-avatar pull-left">
                <img src="{{activity.profileImageURL}}" alt="{{activity.displayName}}">
              </div>
              <small><strong><a class="undecorated-link" ui-sref="profile.info({userId: activity.user})">{{activity.displayName}}</a></strong></small>
              <small>{{activity.action}}</small>
              <small><strong><a class="undecorated-link" ui-sref="polls.view({pollId: activity.poll})">{{activity.title}}</a></strong></small>
              <div class="clearfix"></div>
              <hr class="mg5t mg5b">
            </div>
          </div>
        </div>
      </div>
      <!-- Hot poll -->
      <div class="card">
        <div class="card-header">
          <strong class="card-title">Popular polls</strong>
          <small class="card-link" ng-show="vm.hot_polls.length > 0"><a class="undecorated-link" ui-sref="search({ sort: 'likeCnt' })">View detail</a></small>
        </div>
        <div class="card-body pdnt">
          <uib-tabset active="active" justified="true">
            <uib-tab index="1" heading="Likes">
              <div class="side-list-poll" ng-repeat="poll in vm.hot_polls">
                <div class="user-avatar pull-left">
                  <a ng-if="poll.user" ui-sref="profile.info({userId: poll.user._id})">
                  <img src="{{poll.user.profileImageURL}}" alt="{{poll.user.displayName}}">
                  </a>
                  <img ng-if="!poll.user" src="modules/users/client/img/profile/default.png" alt="Deleted User">
                </div>
                <div class="side-list-body">
                  <h4 class="side-list-title">
                    <a class="undecorated-link" ui-sref="polls.view({pollId: poll._id})" ng-bind="poll.title" autoAdjust></a>
                  </h4>
                  <div class="side-list-entry">
                    <small am-time-ago="poll.created"></small>
                  </div>
                </div>
                <div class="clearfix"></div>
                <hr class="mg5t mg5b">
              </div>
            </uib-tab>
            <uib-tab index="2" heading="Votes">Static content 2</uib-tab>
            <uib-tab index="3" heading="Comments">Static content 3</uib-tab>
          </uib-tabset>
          <!--<ul class="nav nav-tabs" role="tablist">
            <li role="presentation" class="active"><a href="#popular-likes" aria-controls="home" role="tab" data-toggle="tab">Likes</a></li>
            <li role="presentation"><a href="#popular-votes" aria-controls="votes" role="tab" data-toggle="tab">Votes</a></li>
            <li role="presentation"><a href="#popular-comments" aria-controls="comments" role="tab" data-toggle="tab">Comments</a></li>
          </ul>
          <div class="tab-content">
            <div id="popular-likes" class="tab-pane fade in active">
              <div class="side-list-poll" ng-repeat="poll in vm.hot_polls">
                <div class="user-avatar pull-left">
                  <a ng-if="poll.user" ui-sref="profile.info({userId: poll.user._id})">
                  <img src="{{poll.user.profileImageURL}}" alt="{{poll.user.displayName}}">
                  </a>
                  <img ng-if="!poll.user" src="modules/users/client/img/profile/default.png" alt="Deleted User">
                </div>
                <div class="side-list-body">
                  <h4 class="side-list-title">
                    <a class="undecorated-link" ui-sref="polls.view({pollId: poll._id})" ng-bind="poll.title" autoAdjust></a>
                  </h4>
                  <div class="side-list-entry">
                    <small am-time-ago="poll.created"></small>
                  </div>
                </div>
                <div class="clearfix"></div>
                <hr class="mg5t mg5b">
              </div>
            </div>
            <div id="popular-votes" class="tab-pane fade">
              <h2>a</h2>
            </div>
            <div id="popular-comments" class="tab-pane fade">
              <h2>b</h2>
            </div>
          </div>-->
        </div>
      </div>
      <!-- Popular tags -->
      <div class="card">
        <div class="card-header">
          <strong class="card-title">Popular tags</strong>
          <small class="card-link"><a class="undecorated-link" ui-sref="tags.list">View all</a></small>
        </div>
        <div class="card-body">
          <ul class="tags">
            <li ng-repeat="tag in vm.tags"><a ui-sref="tags.polls({ tagId: tag._id })" class="tag">{{tag.name}}({{tag.count}})</a></li>
          </ul>
        </div>
      </div>
    </div>
    <!-- LEFT -->
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-3 col-lg-pull-9 pdn">
      <!-- Category -->
      <div class="card">
        <div class="card-header">
          <strong class="card-title">Categorys</strong>
          <small class="card-link"><a class="undecorated-link" ui-sref="categorys.list">View all</a></small>
        </div>
        <ul class="nav nav-list">
          <li ng-repeat="category in vm.categorys">
            <a class="undecorated-link" ui-sref="categorys.polls({ categoryId: category._id })">
              <i ng-class="['fa', category.icon]"></i>&nbsp;{{category.name}}
              <span class="badge-count pull-right" ng-bind="category.count"></span>
            </a>
          </li>
        </ul>
      </div>
      <!-- Bookmark -->
      <div class="card" ng-if="isLogged && vm.bookmarks.length > 0">
        <div class="card-header">
          <strong class="card-title">Bookmarks</strong>
          <small class="card-link"><a class="undecorated-link" ui-sref="profile.bookmarks({ userId: user._id })">View all</a></small>
        </div>
        <div class="card-body">
          <div class="side-list-poll" ng-repeat="poll in vm.bookmarks">
            <div class="user-avatar pull-left">
              <a ng-if="poll.user" ui-sref="profile.info({userId: poll.user._id})">
                <img src="{{poll.user.profileImageURL}}" alt="{{poll.user.displayName}}">
              </a>
              <img ng-if="!poll.user" src="modules/users/client/img/profile/default.png" alt="Deleted User">
            </div>
            <div class="side-list-body">
              <h4 class="side-list-title">
                <a class="undecorated-link" ui-sref="polls.view({pollId: poll._id})" ng-bind="poll.title" autoAdjust></a>
              </h4>
              <div class="side-list-entry">
                <small am-time-ago="poll.created"></small>
              </div>
            </div>
            <div class="clearfix"></div>
            <hr class="mg5t mg5b">
          </div>
        </div>
      </div>
    </div>
    <div class="clearfix"></div>
  </div>
  <div class="clearfix"></div>
</section>
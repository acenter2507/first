<section class="container">
  <div class="row">
    <!--     <div class="col col-xs-12 col-sm-12 col-md-8 col-lg-8"></div>
    <div class="col col-xs-12 col-sm-12 col-md-4 col-lg-4"></div> -->
    <div class="page-header">
      <h3 ng-bind="vm.poll.title"></h3>
    </div>
    <div class="icon pull-left">
      <a ui-sref="users.info({userId: cmt.user._id})" ng-if="vm.poll.user">
        <img src="{{vm.poll.user.profileImageURL}}" alt="{{vm.poll.user.displayName}}">
      </a>
    </div>
    <small class="pull-left">
      <strong><a ui-sref="users.info({userId: vm.poll.user._id})" ng-if="vm.poll.user" ng-bind="vm.poll.user.displayName"></a></strong>
      <span ng-if="!vm.poll.user">Deleted User</span>
      <span>&nbsp;on&nbsp;</span>
      <span ng-bind="vm.poll.created | date:'mediumDate'"></span>
    </small>
    <br>
    <p class="text-justify" ng-bind="vm.poll.body"></p>
    <span class="pull-right" class="like_tools">
      <a class="like_btn" ng-click="vm.like_poll()" ng-show="vm.like.type == 1"><i class="fa fa-thumbs-o-up" aria-hidden="true"></i></a>
      <span class="like_btn" ng-click="vm.like_poll()" ng-show="vm.like.type != 1"><i class="fa fa-thumbs-o-up" aria-hidden="true"></i></span>
    <span class="mg5l mg5r" ng-bind="vm.poll.likeCnt"></span>
    <a class="like_btn" ng-click="vm.dislike_poll()" ng-show="vm.like.type == 2"><i class="fa fa-thumbs-o-down" aria-hidden="true"></i></a>
    <span class="like_btn" ng-click="vm.dislike_poll()" ng-show="vm.like.type != 2"><i class="fa fa-thumbs-o-down" aria-hidden="true"></i></span>
    </span>
    <div class="clearfix"></div>
    <hr>
  </div>
  <div ui-view="opts"></div>
  <!-- Control -->
  <div class="row">
    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 pdnl pdnr">
      <select class="form-control sort" ng-model="vm.cmt_sort" ng-options="sort.val as sort.name for sort in vm.cmt_sorts"></select>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3 pdnl pdnr">
      <div class="poll_info pull-right">
        <div class="poll_info_item">
          <span class="text-center">VIEW</span>
          <span class="text-center" ng-bind="vm.poll.viewCnt"></span>
          <br>
        </div>
        <div class="poll_info_item">
          <span class="text-center">VOTE</span>
          <span class="text-center" ng-bind="vm.poll.voteCnt"></span>
          <br>
        </div>
        <div class="poll_info_item">
          <span class="text-center">COMMENT</span>
          <span class="text-center" ng-bind="vm.cmts.length"></span>
          <br>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6 pdnl pdnr">
      <div class="pull-right">
        <a class="btn btn-info" ui-sref="polls.edit({ pollId: vm.poll._id })" ng-if="vm.poll.isCurrentUserOwner || vm.poll.canEdit">
          <i class="glyphicon glyphicon-edit"></i> Edit
        </a>
        <a class="btn btn-danger" ng-click="vm.remove()" ng-if="vm.poll.isCurrentUserOwner || vm.poll.canEdit">
          <i class="glyphicon glyphicon-trash"></i> Delete
        </a>
        <button class="btn btn-primary" ng-click="vm.input_cmt()"><i class="fa fa-reply" aria-hidden="true"></i> Reply</button>
        <button ng-if="!vm.poll.isCurrentUserOwner && !vm.poll.canEdit && vm.poll.allow_add && vm.authentication.user" class="btn btn-warning" ng-click="vm.input_opt()"><i class="fa fa-plus" aria-hidden="true"></i> Suggest option</button>
      </div>
    </div>
    <div class="clearfix"></div>
    <hr>
  </div>
  <!-- #Control -->
  <!-- Comment input -->
  <div class="row">
    <div class="col-xs-12">
      <form name="vm.form.cmtForm" class="form-horizontal" novalidate ng-submit="vm.save_cmt(vm.form.cmtForm.$valid)">
        <div class="form-group">
          <span ng-if="vm.tmp_cmt.to">To:&nbsp;</span>
          <a ng-if="vm.tmp_cmt.to" href="#" class="link_btn" ui-sref="users.info({userId: vm.tmp_cmt.to})" ng-bind="vm.tmp_cmt.toName"></a>
          <a href="#" class="mg20l link_btn" ng-click="vm.discard_cmt()" ng-if="vm.tmp_cmt.discard">Discard</a>
        </div>
        <div class="form-group">
          <textarea focus-me="{{vm.cmt_typing}}" name="body" ng-model="vm.tmp_cmt.body" class="form-control" placeholder="Type your reply and enter to send it" ng-enter="vm.save_cmt()"></textarea>
<!--           <div ng-messages="vm.form.cmtForm.body.$error" role="alert">
            <p class="help-block error-text" ng-message="required">You must type something to reply.</p>
          </div> -->
        </div>
        <pre>{{vm.form.cmtForm.$valid}}</pre>
      </form>
    </div>
    <div class="clearfix"></div>
    <hr>
  </div>
  <!-- #Comment input -->
  <div ui-view="cmts"></div>
  <!-- Control -->
  <div class="row" ng-if="vm.cmts.length > 5">
    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 pdnl pdnr">
      <select class="form-control sort" ng-model="vm.cmt_sort" ng-options="sort.val as sort.name for sort in vm.cmt_sorts"></select>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3 pdnl pdnr">
      <div class="poll_info pull-right">
        <div class="poll_info_item">
          <span class="text-center">VIEW</span>
          <span class="text-center" ng-bind="vm.poll.viewCnt"></span>
          <br>
        </div>
        <div class="poll_info_item">
          <span class="text-center">VOTE</span>
          <span class="text-center" ng-bind="vm.poll.voteCnt"></span>
          <br>
        </div>
        <div class="poll_info_item">
          <span class="text-center">COMMENT</span>
          <span class="text-center" ng-bind="vm.cmts.length"></span>
          <br>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6 pdnl pdnr">
      <div class="pull-right">
        <a class="btn btn-info" ui-sref="polls.edit({ pollId: vm.poll._id })" ng-if="vm.poll.isCurrentUserOwner || vm.poll.canEdit">
          <i class="glyphicon glyphicon-edit"></i> Edit
        </a>
        <a class="btn btn-danger" ng-click="vm.remove()" ng-if="vm.poll.isCurrentUserOwner || vm.poll.canEdit">
          <i class="glyphicon glyphicon-trash"></i> Delete
        </a>
        <button class="btn btn-primary" ng-click="vm.input_cmt()"><i class="fa fa-reply" aria-hidden="true"></i> Reply</button>
        <button ng-if="!vm.poll.isCurrentUserOwner && !vm.poll.canEdit && vm.poll.allow_add && vm.authentication.user" class="btn btn-warning" ng-click="vm.input_opt()"><i class="fa fa-plus" aria-hidden="true"></i> Suggest option</button>
      </div>
    </div>
    <div class="clearfix"></div>
    <hr>
  </div>
  <!-- #Control -->
  <div class="row">
    <div class="col-xs-12">
      <h4>Tags: <small>{{(!vm.poll.tags.length) ? 'Has no tag added' : ''}}</small></h4>
      <ul class="tags" ng-show="vm.poll.tags.length">
        <li ng-repeat="tag in vm.poll.tags"><a ui-sref="tags.view({ tagId: tag._id })" class="tag">{{tag.name}}</a></li>
      </ul>
    </div>
  </div>
</section>

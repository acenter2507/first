<div class="row">
  <div class="col-xs-12">
    <div class="form-group">
      <a ng-click="vm.handleCreateTestUsers()" class="btn btn-primary pull-right">
        <i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.busy"></i>Generate
      </a>
      <a ui-sref="admin.users.new" class="btn btn-primary pull-right mg10r">Add new</a>
    </div>
  </div>
</div>

<div class="row mg12t">
  <!-- Filter  -->
  <div class="col-xs-12">
    <uib-accordion close-others="true" ng-init="openAdvance = false;">
      <uib-accordion-group panel-class="custom-panel public" is-open="openAdvance">
        <uib-accordion-heading>
          <i class="fa fa-arrow-circle-down" ng-class="{'fa-rotate-180': openAdvance}"></i> {{:: 'LB_ADVANCE_SEARCH' | translate
          }}
        </uib-accordion-heading>
        <div class="form-group">
          <div class="col-sm-12">
            <label for="sort">{{:: 'LB_SEARCH_SORT_BY' | translate }}</label>
            <select id="sort" name="sort" class="form-control input-sm" ng-model="vm.condition.sort">
                  <option value>{{:: 'LB_SEARCH_NOT_SET' | translate }}</option>
                  <option value="-created">{{:: 'LB_SEARCH_SORT_NEWEST' | translate }}</option>
                  <option value="created">{{:: 'LB_SEARCH_SORT_OLDEST' | translate }}</option>
                  <option value="-likeCnt">{{:: 'LB_SEARCH_SORT_MOST_LIKE' | translate }}</option>
                  <option value="likeCnt">{{:: 'LB_SEARCH_SORT_LEAST_LIKE' | translate }}</option>
                  <option value="-cmtCnt">{{:: 'LB_SEARCH_SORT_MOST_CMT' | translate }}</option>
                  <option value="cmtCnt">{{:: 'LB_SEARCH_SORT_LEAST_CMT' | translate }}</option>
                  <option value="-voteCnt">{{:: 'LB_SEARCH_SORT_MOST_VOTE' | translate }}</option>
                  <option value="voteCnt">{{:: 'LB_SEARCH_SORT_LEAST_VOTE' | translate }}</option>
                  <option value="-viewCnt">{{:: 'LB_SEARCH_SORT_MOST_VIEW' | translate }}</option>
                  <option value="viewCnt">{{:: 'LB_SEARCH_SORT_LEAST_VIEW' | translate }}</option>
                </select>
          </div>
        </div>
        <div class="form-group">
          <!-- Status -->
          <div class="col-sm-6">
            <label for="status">{{:: 'LB_SEARCH_STATUS' | translate }}</label>
            <select id="status" name="status" class="form-control input-sm" ng-model="vm.condition.status">
                  <option value>{{:: 'LB_SEARCH_STATUS_ALL' | translate }}</option>
                  <option value="opening">{{:: 'LB_SEARCH_STATUS_OPENING' | translate }}</option>
                  <option value="closed">{{:: 'LB_SEARCH_STATUS_CLOSED' | translate }}</option>
                </select>
          </div>
          <!-- User -->
          <div class="col-sm-6">
            <label>{{:: 'LB_SEARCH_POST_BY' | translate }}</label>
            <input name="by" type="hidden" class="form-control" ng-model="vm.condition.by">
            <angucomplete-alt placeholder="{{:: 'LB_SEARCH_POST_BY_USER' | translate }}" pause="300" selected-object="vm.selectedUserFn"
              initial-value="selectedUser" remote-url="/api/users/search?s=" remote-url-data-field="users" title-field="displayName"
              description-field="email" image-field="profileImageURL" minlength="1" input-class="form-control input-sm" match-class="highlight"
            />
          </div>
        </div>

        <div class="form-group">
          <div class="col-sm-6">
            <!-- Category -->
            <label>{{:: 'LB_CATEGORY' | translate }}</label>
            <select id="ctgr" name="ctgr" class="form-control input-sm" ng-model="vm.condition.ctgr">
                  <option value>{{:: 'LB_SEARCH_STATUS_ALL' | translate }}</option>
                  <option ng-repeat="category in Categorys.list" value="{{category._id}}" ng-selected="category._id.toString() === vm.condition.ctgr.toString()">{{:: category.name}} ({{:: category.count}})</option>
                </select>
          </div>
          <div class="col-sm-6">
            <div class="col-sm-12 pdn"><label>{{:: 'LB_SEARCH_CREATED' | translate }}</label></div>
            <div class="col-sm-6 pdn">
              <input id="created_start" name="created_start" class="form-control input-sm" today="true" moment-picker="vm.condition.created_start"
                ng-model="vm.condition.created_start" format="YYYY/MM/DD" start-view="month" placeholder="{{:: 'LB_SEARCH_CREATED_START' | translate }}"
                additions="{ bottom: 'start_bottom-template-url' }">
            </div>
            <div class="col-sm-6 pdn">
              <input id="created_end" name="created_end" class="form-control input-sm" today="true" moment-picker="vm.condition.created_end"
                ng-model="vm.condition.created_end" format="YYYY/MM/DD" start-view="month" placeholder="{{:: 'LB_SEARCH_CREATED_END' | translate }}"
                additions="{ bottom: 'end_bottom-template-url' }">
            </div>
          </div>
        </div>
        <div class="form-group">
          <div class="col-sm-4">
            <label for="allow_multiple">{{:: 'LB_POLL_MULTIPLE' | translate }}</label>
            <select id="allow_multiple" name="allow_multiple" class="form-control input-sm" ng-model="vm.condition.allow_multiple">
                <option value>{{:: 'LB_SEARCH_STATUS_ALL' | translate }}</option>
                <option value="true">{{:: 'LB_SEARCH_ALLOW' | translate }}</option>
                <option value="false">{{:: 'LB_SEARCH_DENY' | translate }}</option>
              </select>
          </div>
          <div class="col-sm-4">
            <label for="allow_add">{{:: 'LB_POLL_SUGGEST' | translate }}</label>
            <select id="allow_add" name="allow_add" class="form-control input-sm" ng-model="vm.condition.allow_add">
                  <option value>{{:: 'LB_SEARCH_STATUS_ALL' | translate }}</option>
                  <option value="true">{{:: 'LB_SEARCH_ALLOW' | translate }}</option>
                  <option value="false">{{:: 'LB_SEARCH_DENY' | translate }}</option>
                </select>
          </div>
          <div class="col-sm-4">
            <label for="allow_guest">{{:: 'LB_POLL_ALLOW_GUEST' | translate }}</label>
            <select id="allow_guest" name="allow_guest" class="form-control input-sm" ng-model="vm.condition.allow_guest">
                  <option value>{{:: 'LB_SEARCH_STATUS_ALL' | translate }}</option>
                  <option value="true">{{:: 'LB_SEARCH_ALLOW' | translate }}</option>
                  <option value="false">{{:: 'LB_SEARCH_DENY' | translate }}</option>
                </select>
          </div>
        </div>
        <div class="form-group">
          <div class="col-sm-6">
            <div class="col-sm-12 pdn"><label>{{:: 'LB_SEARCH_CMT_CNT' | translate }}</label></div>
            <div class="col-sm-6 pdn">
              <select class="form-control input-sm" ng-model="vm.condition.cmts_pref">
                    <option value>{{:: 'LB_SEARCH_NOT_SET' | translate }}</option>
                    <option value="least">{{:: 'LB_SEARCH_CNT_LEAST' | translate }}</option>
                    <option value="most">{{:: 'LB_SEARCH_CNT_MOST' | translate }}</option>
                  </select>
            </div>
            <div class="col-sm-6 pdn">
              <input name="cmts" id="cmts" type="text" class="form-control input-sm" placeholder="{{:: 'LB_SEARCH_CMT_CNT' | translate }}"
                ng-model="vm.condition.cmts">
            </div>
          </div>
          <div class="col-sm-6">
            <div class="col-sm-12 pdn"><label>{{:: 'LB_SEARCH_LIKE_CNT' | translate }}</label></div>
            <div class="col-sm-6 pdn">
              <select class="form-control input-sm" ng-model="vm.condition.likes_pref">
                    <option value>{{:: 'LB_SEARCH_NOT_SET' | translate }}</option>
                    <option value="least">{{:: 'LB_SEARCH_CNT_LEAST' | translate }}</option>
                    <option value="most">{{:: 'LB_SEARCH_CNT_MOST' | translate }}</option>
                  </select>
            </div>
            <div class="col-sm-6 pdn">
              <input name="likes" id="likes" type="text" class="form-control input-sm" placeholder="{{:: 'LB_SEARCH_LIKE_CNT' | translate }}"
                ng-model="vm.condition.likes">
            </div>
          </div>
        </div>
        <div class="form-group">
          <div class="col-sm-6">
            <div class="col-sm-12 pdn"><label>{{:: 'LB_SEARCH_VOTE_CNT' | translate }}</label></div>
            <div class="col-sm-6 pdn">
              <select class="form-control input-sm" ng-model="vm.condition.votes_pref">
                    <option value>{{:: 'LB_SEARCH_NOT_SET' | translate }}</option>
                    <option value="least">{{:: 'LB_SEARCH_CNT_LEAST' | translate }}</option>
                    <option value="most">{{:: 'LB_SEARCH_CNT_MOST' | translate }}</option>
                  </select>
            </div>
            <div class="col-sm-6 pdn">
              <input name="votes" id="votes" type="text" class="form-control input-sm" placeholder="{{:: 'LB_SEARCH_VOTE_CNT' | translate }}"
                ng-model="vm.condition.votes">
            </div>
          </div>
          <div class="col-sm-6">
            <div class="col-sm-12 pdn"><label>{{:: 'LB_SEARCH_VIEW_CNT' | translate }}</label></div>
            <div class="col-sm-6 pdn">
              <select class="form-control input-sm" ng-model="vm.condition.views_pref">
                    <option value>{{:: 'LB_SEARCH_NOT_SET' | translate }}</option>
                    <option value="least">{{:: 'LB_SEARCH_CNT_LEAST' | translate }}</option>
                    <option value="most">{{:: 'LB_SEARCH_CNT_MOST' | translate }}</option>
                  </select>
            </div>
            <div class="col-sm-6 pdn">
              <input name="views" id="views" type="text" class="form-control input-sm" placeholder="{{:: 'LB_SEARCH_VIEW_CNT' | translate }}"
                ng-model="vm.condition.views">
            </div>
          </div>
        </div>
      </uib-accordion-group>
    </uib-accordion>
  </div>
  <!-- <div class="card card-expand">

    <div class="card-header">
      <strong class="card-title">Filter tools</strong>
      <a class="card-expand-toggle card-link"><i class="fa fa-arrow-circle-down"></i></a>
      <div class="clearfix"></div>
    </div>
    <hr class="mgn">
    <div class="card-body">
      <div class="row">
        <div class="form-group col-sm-6">
          <label for="search">Search</label>
          <input name="search" id="search" class="form-control input-sm" type="text" ng-model="filter.search" placeholder="Search"
            ng-change="figureOutItemsToDisplay()" />
        </div>
        <div class="form-group col-sm-6">
          <label for="sort">Sort by</label>
          <select id="sort" name="sort" class="form-control input-sm" ng-model="filter.sort" ng-change="figureOutItemsToDisplay()">
              <option value>Default</option>
              <option value="-created">Newest to oldest</option>
              <option value="created">Oldest to newest</option>
              <option value="-report.pollCnt">Most polls</option>
              <option value="report.pollCnt">Least polls</option>
              <option value="-report.cmtCnt">Most comments</option>
              <option value="report.cmtCnt">Least comments</option>
            </select>
        </div>
      </div>
      <div class="row">
        <div class="form-group col-sm-4">
          <label for="status">Status</label>
          <select id="status" name="status" class="form-control input-sm" ng-model="filter.status" ng-change="figureOutItemsToDisplay()"
            disabled>
              <option value>All</option>
              <option value="active">Online</option>
              <option value="offline">Offline</option>
            </select>
        </div>
        <div class="form-group col-sm-4">
          <label for="provider">Provider</label>
          <select id="provider" name="provider" class="form-control input-sm" ng-model="filter.provider" ng-change="figureOutItemsToDisplay()">
              <option value>All</option>
              <option value="local">Local</option>
              <option value="facebook">Facebook</option>
              <option value="twitter">Twitter</option>
              <option value="linkedin">Linkedin</option>
              <option value="google">Google plus</option>
              <option value="github">Github</option>
            </select>
        </div>
        <div class="form-group col-sm-4">
          <label for="created">Joined date</label>
          <input id="created" name="created" class="form-control input-sm" today="true" moment-picker="filter.created" ng-model="filter.created"
            format="YYYY/MM/DD" start-view="month" placeholder="Select a date..." change="figureOutItemsToDisplay()" additions="{ bottom: 'bottom-template-url' }">
        </div>
      </div>
      <div class="row">
        <div class="form-group col-sm-6">
          <div class="col-sm-12 pdn"><label>Number of polls</label></div>
          <div class="col-sm-6 pdn">
            <select class="form-control input-sm" ng-model="filter.polls_pref" ng-change="figureOutItemsToDisplay()">
                <option value>None</option>
                <option value="least">As least</option>
                <option value="most">As most</option>
              </select>
          </div>
          <div class="col-sm-6 pdn">
            <input name="polls" id="polls" type="text" class="form-control input-sm" placeholder="Enter number of polls" ng-model="filter.polls"
              ng-change="figureOutItemsToDisplay()">
          </div>
        </div>
        <div class="form-group col-sm-6">
          <label for="roles">Role</label>
          <select id="roles" name="roles" class="form-control input-sm" ng-model="filter.roles" ng-change="figureOutItemsToDisplay()">
              <option value>All</option>
              <option value="admin">Admin</option>
              <option value="user">User</option>
            </select>
        </div>
      </div>
      <div class="clearfix"></div>
    </div>
    <hr class="mgn">
    <div class="card-footer">
      <a class="btn btn-danger btn-sm pull-right" ng-click="clear_filter()">Clear</a>
      <div class="clearfix"></div>
    </div>
  </div> -->
</div>

<div class="row">
  <div class="col-xs-12">

    <div class="table-responsive">
      <table class="table table-bordered">
        <thead class="bg-primary">
          <tr>
            <th class="text-center">Avatar</th>
            <th>Name</th>
            <th>Email</th>
            <th>Joined</th>
            <th>Role</th>
            <th class="text-center">Provider</th>
            <th class="text-center">Polls</th>
            <th class="text-center">Comments</th>
            <th class="text-center">Profile views</th>
            <th class="text-center">Be reported</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="user in vm.users">
            <td class="text-center">
              <div class="admin-avatar">
                <img src="{{:: user.profileImageURL }}" class="img-admin-avatar">
              </div>
            </td>

            <td>{{:: user.displayName }}</td>
            <td>{{:: user.email }}</td>
            <td>{{:: user.created | LLL_format }}</td>
            <td>{{:: user.roles }}</td>
            <td class="text-center">
              <i class="fa" ng-class="{ 'fa fa-facebook-square' : user.provider === 'facebook',
                    'fa fa-twitter-square' : user.provider === 'twitter',
                    'fa fa-linkedin-square' : user.provider === 'linkedin',
                    'fa fa-google-plus-square' : user.provider === 'google',
                    'fa fa-git-square' : user.provider === 'github',
                    'fa fa-sign-in' : user.provider === 'local'}">
                </i>
            </td>
            <td class="text-center">{{:: user.report.pollCnt }}</td>
            <td class="text-center">{{:: user.report.cmtCnt }}</td>
            <td class="text-center">{{:: user.report.viewCnt }}</td>
            <td class="text-center">{{:: user.report.beReportCnt }}</td>
            <td>
              <div class="dropdown" uib-dropdown>
                <a class="btn btn-primary btn-sm" role="button" uib-dropdown-toggle>Options</a>
                <ul class="dropdown-menu" role="menu" style="left: -100px; z-index: 2;">
                  <li><a ui-sref="admin.users.view({ userId: user._id })">Detail</a></li>
                  <li><a ui-sref="admin.users.edit({ userId: user._id })">Edit</a></li>
                  <li><a ng-click="vm.handleDeleteUser(user)">Delete</a></li>
                  <li ng-if="user.provider === 'local'"><a ui-sref="admin.users.resetpass({ userId: user._id })">Reset password</a></li>
                </ul>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <ul class="pagination">
        <li ng-repeat="page in vm.totalPage" ng-class="{'active': page === vm.page}"><a ng-click="vm.handleChangePage(page)">{{page}}</a></li>
      </ul>
    </div>
  </div>
</div>

<!--
<div class="row">
  <div class="card">
    <div class="card-header">
      <strong class="card-title"><i class="fa fa-list-alt"></i> List user</strong>
      <a class="card-link" ui-sref="admin.users.new">Add new</a>
      <div class="clearfix"></div>
    </div>
    <hr class="mgn">
    <div class="card-body">
      <div class="clearfix"></div>
    </div>
  </div>
</div>-->

<script type="text/ng-template" id="bottom-template-url">
  <button class="btn btn-info btn-sm btn-block" ng-click="filter.created = undefined">
    Clear
  </button>
</script>